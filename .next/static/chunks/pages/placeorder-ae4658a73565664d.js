(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{4631:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/placeorder",function(){return r(5859)}])},9780:function(e,n,r){"use strict";r.d(n,{Z:function(){return s}});var t=r(5893);r(7294);function s(e){var n=e.activeStep,r=void 0===n?0:n;return(0,t.jsx)("div",{className:"mb-5 flex flex-wrap",children:["Utilisateur","Adresse de livraison","Moyen de paiement","Valider la commande"].map((function(e,n){return(0,t.jsx)("div",{className:"flex-1 border-b-2  \n          text-center \n       ".concat(n<=r?"border-indigo-500   text-indigo-500":"border-gray-400 text-gray-400","\n          \n       "),children:e},e)}))})}},3399:function(e,n,r){"use strict";r.d(n,{Z:function(){return b}});var t=r(5893),s=r(3299),i=r(9008),c=r(1664),a=r.n(c),l=r(1955),d=r(7294),o=r(5538),h=r(4247),u=(r(4213),r(2148));function x(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){x(e,n,r[n])}))}return e}function f(e,n){if(null==e)return{};var r,t,s=function(e,n){if(null==e)return{};var r,t,s={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function j(e){var n=e.href,r=e.children,s=f(e,["href","children"]);return(0,t.jsx)(a(),{href:n,children:(0,t.jsx)("a",m({},s,{children:r}))})}var p=r(1163),v=r(3737);function b(e){var n=e.title,r=e.children,c=(0,s.useSession)(),x=c.status,m=c.data,f=(0,d.useContext)(u.y),b=f.state,y=f.dispatch,g=b.cart,N=(0,d.useState)(0),w=N[0],O=N[1];(0,d.useEffect)((function(){O(g.cartItems.reduce((function(e,n){return e+n.quantity}),0))}),[g.cartItems]);var P=(0,d.useState)(""),S=P[0],k=P[1],C=(0,p.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.default,{children:[(0,t.jsx)("title",{children:n?n+" - AnalyaTech":"AnalyaTech"}),(0,t.jsx)("meta",{name:"description",content:"Miner Shop"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)(o.Ix,{position:"bottom-center",limit:1}),(0,t.jsxs)("div",{className:"flex min-h-screen flex-col justify-between ",children:[(0,t.jsx)("header",{children:(0,t.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,t.jsx)(a(),{href:"/",children:(0,t.jsx)("a",{className:"text-lg font-bold",children:"AnalyaTech"})}),(0,t.jsxs)("form",{onSubmit:function(e){e.preventDefault(),C.push("/search?query=".concat(S))},className:"mx-auto hidden w-full justify-center md:flex",children:[(0,t.jsx)("input",{onChange:function(e){return k(e.target.value)},type:"text",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"analyatech.fr"}),(0,t.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,t.jsx)(v.Z,{className:"h-5 w-"})})]}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(a(),{href:"/cart",children:(0,t.jsxs)("a",{className:"p-2",children:["Panier",w>0&&(0,t.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:w})]})}),"loading"===x?"Loading":(null===m||void 0===m?void 0:m.user)?(0,t.jsxs)(h.v,{as:"div",className:"relative flex",children:[(0,t.jsx)(h.v.Button,{className:"text-blue-600 ",children:m.user.name}),(0,t.jsxs)(h.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-white shadow-lg ",children:[(0,t.jsx)(h.v.Item,{children:(0,t.jsx)(j,{className:"dropdown-link",href:"/profile",children:"Profil"})}),(0,t.jsx)(h.v.Item,{children:(0,t.jsx)(j,{className:"dropdown-link",href:"/order-history",children:"Commandes"})}),m.user.isAdmin&&(0,t.jsx)(h.v.Item,{children:(0,t.jsx)(j,{className:"dropdown-link",href:"/admin/dashboard",children:"Panneau Admin"})}),(0,t.jsx)(h.v.Item,{children:(0,t.jsx)("a",{className:"dropdown-link",href:"#",onClick:function(){l.Z.remove("cart"),y({type:"CART_RESET"}),(0,s.signOut)({callbackUrl:"/login"})},children:"Se d\xe9connecter"})})]})]}):(0,t.jsx)(a(),{href:"/login",children:(0,t.jsx)("a",{className:"p-2",children:"Connexion"})})]})]})}),(0,t.jsx)("main",{className:"container m-auto mt-4 px-4",children:r}),(0,t.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:(0,t.jsx)("p",{children:"2023 AnalyaTech"})})]})]})}},5859:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return w}});var t=r(4051),s=r.n(t),i=r(5893),c=r(9669),a=r.n(c),l=r(5675),d=r.n(l),o=r(1664),h=r.n(o),u=r(1163),x=r(1955),m=r(7294),f=r(5538),j=r(9780),p=r(3399),v=r(5738),b=r(2148);function y(e,n,r,t,s,i,c){try{var a=e[i](c),l=a.value}catch(d){return void r(d)}a.done?n(l):Promise.resolve(l).then(t,s)}function g(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function N(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){g(e,n,r[n])}))}return e}function w(){var e=(0,m.useContext)(b.y),n=e.state,r=e.dispatch,t=n.cart,c=t.cartItems,l=t.shippingAddress,o=t.paymentMethod,g=function(e){return Math.round(100*e+Number.EPSILON)/100},w=g(c.reduce((function(e,n){return e+n.quantity*n.price}),0)),O=w>200?0:15,P=g(.15*w),S=g(w+O+P),k=(0,u.useRouter)();(0,m.useEffect)((function(){o||k.push("/payment")}),[o,k]);var C=(0,m.useState)(!1),_=C[0],A=C[1],E=function(){var e,n=(e=s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A(!0),e.next=4,a().post("/api/orders",{orderItems:c,shippingAddress:l,paymentMethod:o,itemsPrice:w,shippingPrice:O,taxPrice:P,totalPrice:S});case 4:n=e.sent.data,A(!1),r({type:"CART_CLEAR_ITEMS"}),x.Z.set("cart",JSON.stringify(N({},t,{cartItems:[]}))),k.push("/order/".concat(n._id)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),A(!1),f.Am.error((0,v.b)(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})),function(){var n=this,r=arguments;return new Promise((function(t,s){var i=e.apply(n,r);function c(e){y(i,t,s,c,a,"next",e)}function a(e){y(i,t,s,c,a,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,i.jsxs)(p.Z,{title:"Commander",children:[(0,i.jsx)(j.Z,{activeStep:3}),(0,i.jsx)("h1",{className:"mb-4 text-xl",children:"Passer la commande"}),0===c.length?(0,i.jsxs)("div",{children:["Panier vide. ",(0,i.jsx)(h(),{href:"/",children:"Continuer vos achats"})]}):(0,i.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-5",children:[(0,i.jsxs)("div",{className:"overflow-x-auto md:col-span-3",children:[(0,i.jsxs)("div",{className:"card p-5",children:[(0,i.jsx)("h2",{className:"mb-2 text-lg",children:"Adresse de livraison"}),(0,i.jsxs)("div",{children:[l.fullName,", ",l.address,","," ",l.city,", ",l.postalCode,","," ",l.country]}),(0,i.jsx)("div",{children:(0,i.jsx)(h(),{href:"/shipping",children:"Modifier"})})]}),(0,i.jsxs)("div",{className:"card p-5",children:[(0,i.jsx)("h2",{className:"mb-2 text-lg",children:"Moyen de paiement"}),(0,i.jsx)("div",{children:o}),(0,i.jsx)("div",{children:(0,i.jsx)(h(),{href:"/payment",children:"Modifier"})})]}),(0,i.jsxs)("div",{className:"card overflow-x-auto p-5",children:[(0,i.jsx)("h2",{className:"mb-2 text-lg",children:"Votre commande"}),(0,i.jsxs)("table",{className:"min-w-full",children:[(0,i.jsx)("thead",{className:"border-b",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-5 text-left",children:"Article(s)"}),(0,i.jsx)("th",{className:" p-5 text-right",children:"Quantit\xe9"}),(0,i.jsx)("th",{className:" p-5 text-right",children:"Prix"}),(0,i.jsx)("th",{className:"p-5 text-right",children:"Sous total"})]})}),(0,i.jsx)("tbody",{children:c.map((function(e){return(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("td",{children:(0,i.jsx)(h(),{href:"/product/".concat(e.slug),children:(0,i.jsxs)("a",{className:"flex items-center",children:[(0,i.jsx)(d(),{src:e.image,alt:e.name,width:50,height:50}),"\xa0",e.name]})})}),(0,i.jsx)("td",{className:" p-5 text-right",children:e.quantity}),(0,i.jsxs)("td",{className:"p-5 text-right",children:["$",e.price]}),(0,i.jsxs)("td",{className:"p-5 text-right",children:["$",e.quantity*e.price]})]},e._id)}))})]}),(0,i.jsx)("div",{children:(0,i.jsx)(h(),{href:"/cart",children:"Modifier"})})]})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"card p-5",children:[(0,i.jsx)("h2",{className:"mb-2 text-lg",children:"R\xe9sum\xe9 de la commande"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,i.jsx)("div",{children:"Article(s)"}),(0,i.jsxs)("div",{children:["$",w]})]})}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,i.jsx)("div",{children:"Taxe"}),(0,i.jsxs)("div",{children:["$",P]})]})}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,i.jsx)("div",{children:"Livraison"}),(0,i.jsxs)("div",{children:["$",O]})]})}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,i.jsx)("div",{children:"Total"}),(0,i.jsxs)("div",{children:["$",S]})]})}),(0,i.jsx)("li",{children:(0,i.jsx)("button",{disabled:_,onClick:E,className:"primary-button w-full",children:_?"Chargement...":"Commander"})})]})]})})]})]})}w.auth=!0},5738:function(e,n,r){"use strict";r.d(n,{b:function(){return t}});var t=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}}},function(e){e.O(0,[849,669,675,774,888,179],(function(){return n=4631,e(e.s=n);var n}));var n=e.O();_N_E=n}]);